MIGRATION FROM SQLITE TO POSTGRESQL from Claude Sonnet 4.5 in Studio Code
====================================

Step 1: Export data from SQLite
--------------------------------
Command:
uv run python djangocmsjoy/manage.py dumpdata --natural-foreign --natural-primary -e contenttypes -e auth.Permission > datadump.json

This exports all data except contenttypes and permissions (which will be recreated by migrations).
Result: Created datadump.json (4.7KB with 18 objects)


Step 2: Check PostgreSQL installation
--------------------------------------
Command:
which psql

Result: PostgreSQL client found at /opt/homebrew/bin/psql


Step 3: Start PostgreSQL service
---------------------------------
Command:
brew services start postgresql@15

Result: Successfully started PostgreSQL 15


Step 4: Create PostgreSQL database
-----------------------------------
Command:
createdb djangocmsjoy

This creates a new database named "djangocmsjoy" with your system user as the owner.


Step 5: Update Django settings.py
----------------------------------
Changed DATABASES configuration from:

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}

To:

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'djangocmsjoy',
        'USER': 'jelambeadmin',
        'PASSWORD': '',  # No password for local development
        'HOST': 'localhost',
        'PORT': '5432',
    }
}

Note: psycopg2-binary package was already in dependencies (required for PostgreSQL)


Step 6: Run migrations on PostgreSQL
-------------------------------------
Command:
uv run python djangocmsjoy/manage.py migrate

This creates all tables in the PostgreSQL database.
Result: Applied 63 migrations successfully


Step 7: Import data into PostgreSQL
------------------------------------
Command:
uv run python djangocmsjoy/manage.py loaddata datadump.json

Result: Installed 18 object(s) from 1 fixture(s)
This imported all users, pages, and CMS content.


Step 8: Verify and restart server
----------------------------------
Command:
uv run python djangocmsjoy/manage.py runserver

The application now runs on PostgreSQL with all previous data intact.


ADDITIONAL NOTES
================

- PostgreSQL service must be running for the app to work:
  brew services start postgresql@15

- To stop PostgreSQL:
  brew services stop postgresql@15

- To check PostgreSQL status:
  brew services list

- To connect to the database directly:
  psql djangocmsjoy

- The old SQLite database (db.sqlite3) is still in the project but no longer used.
  You can keep it as a backup or delete it.

- The datadump.json file contains the exported data and can be kept as a backup.
